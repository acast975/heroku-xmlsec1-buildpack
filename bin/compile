#!/usr/bin/env bash

# The location of the pre-compiled xmlsec1 binary.
VENDORED_XMLSEC1="http://160.99.9.199/astanimirovic/xmlsec1-1.2.tgz"

# change to correct directory.
echo "Create direcories"
cd "$1" 
mkdir -p "xmlsec1-1.2"
cd "xmlsec1-1.2"

# Download and untar xmlsec1 library
echo "Downloading xmlsec1 library"
curl -s -L -o tmp-libxmlsec1.tar.gz $VENDORED_XMLSEC1

echo "Untar xmlsec1 library"
tar -zxf tmp-libxmlsec1.tar.gz # > /dev/null #TODO Hide this output

#echo "Copy xmlsec1 bin directory"
#cp ./bin/* $1/.heroku/python/bin

#echo "Copy xmlsec1 lib directory"
#cp ./bin/* $1/.heroku/python/bin

echo "Remove temporary files"
rm tmp-libxmlsec1.tar.gz


echo "export PATH=$PATH:$1/xmlsec1-1.2/bin" >> "/app/.profile.d/python.sh"
echo "export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$1/xmlsec1-1.2/lib" >> "/app/.profile.d/python.sh"

#echo "Remove env variables"
#set-env PATH '$1/xmlsec1-1.2/bin:$PATH'
#set-env LD_LIBRARY_PATH '$1/xmlsec1-1.2/lib:$LD_LIBRARY_PATH'